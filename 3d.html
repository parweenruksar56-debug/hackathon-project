<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cosmic Watch ‚Äì 3D Asteroid Dashboard</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: black;
    font-family: Arial, sans-serif;
  }
  #panel {
    position: absolute;
    top: 15px;
    left: 15px;
    background: rgba(0,0,0,0.65);
    padding: 15px;
    color: white;
    width: 270px;
    border-radius: 10px;
    z-index: 10;
  }
  h2 {
    margin-top: 0;
    color: #4da6ff;
  }
  #controls {
    position: absolute;
    bottom: 20px;
    left: 20px;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    z-index: 10;
  }
  #controls button {
    padding: 8px 12px;
    background: rgba(0,0,0,0.7);
    color: #4da6ff;
    border: 1px solid #4da6ff;
    border-radius: 6px;
    cursor: pointer;
    font-size: 13px;
  }
  #controls button:hover {
    background: #4da6ff;
    color: black;
  }
</style>
</head>
<body>

<div id="panel">
  <h2>üåå Cosmic Watch</h2>
  <p><b>Status:</b> 3D Monitoring Active</p>
  <p>Mouse Wheel ‚Üí Zoom</p>
  <div id="details">Click an asteroid</div>
</div>

<div id="controls">
  <button onclick="zoomIn()">‚ûï Zoom In</button>
  <button onclick="zoomOut()">‚ûñ Zoom Out</button>
  <button onclick="resetView()">üéØ Reset</button>
  <button onclick="togglePause()">‚è∏ Pause</button>
  <button onclick="toggleOrbits()">ü™ê Orbits</button>
  <button onclick="filterHazard()">üö® Hazard Only</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script>
// ================= Scene =================
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(
  60,
  window.innerWidth / window.innerHeight,
  0.1,
  20000
);
camera.position.z = 1200;

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// ================= Stars =================
const starGeo = new THREE.BufferGeometry();
const starVerts = [];
for (let i = 0; i < 4000; i++) {
  starVerts.push(
    (Math.random() - 0.5) * 10000,
    (Math.random() - 0.5) * 10000,
    (Math.random() - 0.5) * 10000
  );
}
starGeo.setAttribute("position", new THREE.Float32BufferAttribute(starVerts, 3));
scene.add(new THREE.Points(starGeo, new THREE.PointsMaterial({ color: 0xffffff, size: 1.2 })));

// ================= Lights =================
scene.add(new THREE.AmbientLight(0x404040, 0.6));

const sunLight = new THREE.PointLight(0xfff5e1, 3.2, 0);
sunLight.position.set(3000, 0, 0);
scene.add(sunLight);

// ================= Realistic Sun =================
const sunGroup = new THREE.Group();
sunGroup.position.set(3000, 0, 0);
scene.add(sunGroup);

// Core sun
const sunCore = new THREE.Mesh(
  new THREE.SphereGeometry(220, 48, 48),
  new THREE.MeshStandardMaterial({
    color: 0xffeecc,
    emissive: 0xffaa33,
    emissiveIntensity: 1.4,
    metalness: 0.1,
    roughness: 0.9
  })
);
sunGroup.add(sunCore);

// Glow halo (outer corona)
const glowGeo = new THREE.SphereGeometry(340, 32, 32);
const glowMat = new THREE.MeshBasicMaterial({
  color: 0xffdd88,
  transparent: true,
  opacity: 0.35,
  blending: THREE.AdditiveBlending
});
const glow = new THREE.Mesh(glowGeo, glowMat);
sunGroup.add(glow);

// Extra subtle flare layer
const flareGeo = new THREE.SphereGeometry(420, 32, 32);
const flareMat = new THREE.MeshBasicMaterial({
  color: 0xffbb66,
  transparent: true,
  opacity: 0.15,
  blending: THREE.AdditiveBlending
});
const flare = new THREE.Mesh(flareGeo, flareMat);
sunGroup.add(flare);

// ================= Earth =================
const earth = new THREE.Mesh(
  new THREE.SphereGeometry(120, 64, 64),
  new THREE.MeshStandardMaterial({
    map: new THREE.TextureLoader().load(
      "https://threejs.org/examples/textures/land_ocean_ice_cloud_2048.jpg"
    )
  })
);
earth.rotation.z = THREE.MathUtils.degToRad(23.5);
scene.add(earth);

// ================= Orbits =================
const orbitLines = [];
function createOrbit(a, b, tilt) {
  const curve = new THREE.EllipseCurve(0, 0, a, b, 0, Math.PI * 2);
  const points = curve.getPoints(400);
  const geo = new THREE.BufferGeometry().setFromPoints(points);
  const line = new THREE.LineLoop(
    geo,
    new THREE.LineBasicMaterial({ color: 0xffdd88, opacity: 0.35, transparent: true })
  );
  line.rotation.x = Math.PI / 2;
  line.rotation.z = tilt;
  scene.add(line);
  orbitLines.push(line);
}

// ================= Asteroids =================
const asteroids = [];
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();

function createAsteroid(name, hazardous, size, speed, a, b) {
  const tilt = THREE.MathUtils.degToRad(THREE.MathUtils.randFloat(-10, 10));
  createOrbit(a, b, tilt);
  const asteroid = new THREE.Mesh(
    new THREE.SphereGeometry(size, 16, 16),
    new THREE.MeshStandardMaterial({
      color: hazardous ? 0xff4444 : 0xaaaaaa,
      emissive: hazardous ? 0x330000 : 0x000000,
      emissiveIntensity: hazardous ? 0.4 : 0
    })
  );
  asteroid.userData = {
    name, hazardous, speed, a, b,
    angle: Math.random() * Math.PI * 2
  };
  asteroids.push(asteroid);
  scene.add(asteroid);
}

// Sample asteroids
createAsteroid("Ast-2024-A", true, 15, 0.007, 350, 280);
createAsteroid("Ast-2024-B", false, 10, 0.004, 500, 420);
createAsteroid("Ast-2024-C", true, 18, 0.006, 680, 560);
createAsteroid("Ast-2024-D", false, 8, 0.003, 850, 730);

// ================= Interaction =================
window.addEventListener("click", e => {
  mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
  raycaster.setFromCamera(mouse, camera);
  const hits = raycaster.intersectObjects(asteroids);
  if (hits.length) {
    const a = hits[0].object.userData;
    document.getElementById("details").innerHTML = `
      <b>Name:</b> ${a.name}<br>
      <b>Hazardous:</b> ${a.hazardous ? "Yes" : "No"}<br>
      <b>Orbit A/B:</b> ${a.a} √ó ${a.b}
    `;
  }
});

// ================= Controls =================
let paused = false, hazardOnly = false, orbitsVisible = true;

function zoomIn() { camera.position.z = Math.max(400, camera.position.z - 120); }
function zoomOut() { camera.position.z = Math.min(3500, camera.position.z + 120); }
function resetView() { camera.position.set(0, 0, 1200); }
function togglePause() { paused = !paused; }
function toggleOrbits() {
  orbitsVisible = !orbitsVisible;
  orbitLines.forEach(o => o.visible = orbitsVisible);
}
function filterHazard() {
  hazardOnly = !hazardOnly;
  asteroids.forEach(a => a.visible = hazardOnly ? a.userData.hazardous : true);
}

window.addEventListener("wheel", e => {
  camera.position.z += e.deltaY * 0.5;
  camera.position.z = THREE.MathUtils.clamp(camera.position.z, 400, 3500);
});

// ================= Animation =================
let time = 0;
function animate() {
  requestAnimationFrame(animate);

  time += 0.016;

  // Sun breathing effect
  const pulse = 1 + Math.sin(time * 1.5) * 0.03;
  glow.scale.setScalar(pulse);
  flare.scale.setScalar(pulse * 1.2);

  earth.rotation.y += 0.0015;

  if (!paused) {
    asteroids.forEach(a => {
      a.userData.angle += a.userData.speed;
      a.position.set(
        Math.cos(a.userData.angle) * a.userData.a,
        0,
        Math.sin(a.userData.angle) * a.userData.b
      );
    });
  }

  renderer.render(scene, camera);
}
animate();

// ================= Resize =================
window.addEventListener("resize", () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>